{{ define "main" }}
<article>
    <h1>{{ .Title }}</h1>
    
    {{ if .Content }}
    <div class="content">
        {{ .Content }}
    </div>
    {{ end }}
    
    {{ if .Params.pdf }}
    <div class="pdf-container">
        {{ $pdfPath := .Params.pdf }}
        {{ $pdfFilename := index (split $pdfPath "/") -1 }}
        {{ $absoluteURL := printf "%s%s" (strings.TrimSuffix "/" .Site.BaseURL) $pdfPath }}
        
        <div style="border: 2px dashed #ddd; padding: 2rem; text-align: center; background: #f9f9f9; border-radius: 8px; margin: 2rem 0;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">üìÑ</div>
            <h3 style="margin-bottom: 0.5rem;">PDF Document: {{ $pdfFilename }}</h3>
            <p style="color: #666; margin-bottom: 1.5rem;">Click the buttons below to view or download this document.</p>
            
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <a href="{{ $absoluteURL }}" target="_blank" class="pdf-download" style="text-decoration: none;">
                    üëÅÔ∏è View PDF
                </a>
                <button onclick="downloadPDF('{{ $absoluteURL }}', '{{ $pdfFilename }}')" class="pdf-download" style="border: none; cursor: pointer; font-size: inherit; font-family: inherit;">
                    ‚¨áÔ∏è Download PDF
                </button>
            </div>
        </div>
        
        <div style="margin-top: 2rem;">
            <object data="{{ $absoluteURL }}" type="application/pdf" class="pdf-viewer" style="display: none;" id="pdf-object">
                <embed src="{{ $absoluteURL }}" type="application/pdf" class="pdf-viewer" />
                <p>Your browser does not support PDFs. 
                <a href="{{ $absoluteURL }}" target="_blank">Open in new tab</a> to view.</p>
            </object>
        </div>
        
        <div style="margin-top: 1rem; padding: 1rem; background: #f5f5f5; border-radius: 4px;">
            <p style="margin: 0; font-size: 0.9em; color: #666;">
                <strong>Direct link:</strong> 
                <a href="{{ $absoluteURL }}" target="_blank" style="color: #667eea; word-break: break-all;">{{ $absoluteURL }}</a>
            </p>
        </div>
    </div>
    
    <script>
    function downloadPDF(url, filename) {
        fetch(url)
            .then(response => response.blob())
            .then(blob => {
                const link = document.createElement('a');
                link.href = window.URL.createObjectURL(blob);
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(link.href);
            })
            .catch(error => {
                console.error('Download failed:', error);
                // Fallback to direct link
                window.open(url, '_blank');
            });
    }
    </script>
    {{ end }}
</article>
{{ end }}

